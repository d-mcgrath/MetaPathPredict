#library(bundle) - doesn't work with xgboost - gives an error
gx = gM00001
View(gx$coefs$preproc$terms)

#gx$model_defs$xgboost_tune$pre$actions$recipe = NULL
#gx$model_defs$nnet_tune$pre$actions$recipe = NULL

# issue is in the coefficients
gx$coefs$preproc$terms = NULL
size(serialize(gx, NULL))

saveRDS(gx, file = '~/Downloads/test_model_dec5_2022.rds')



bx = gx$coefs
View(gx)


cx = bx |> flatten()
View(cx)



View(gx)

for (x in 'gx') {
  RSQLite::dbExecute(model_db,
                     'INSERT INTO models VALUES (:model_name, :raw_model)',
                     params = list(
                       model_name = x,
                       raw_model = list(serialize(get(x), NULL))
                     ))
}

size(serialize(M00001, NULL))
size(serialize(gM00001, NULL))

